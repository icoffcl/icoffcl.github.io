<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-store, no-cache, must-revalidate, proxy-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>ICOFFCL - Indunil Chathuranga Official</title>
    <link
      rel="icon"
      href="https://i.ibb.co/SXxWmZZ/Photoroom-20240810-231545.png"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="../styles.css" />
    <style></style>
  </head>
  <body>
    <nav>
      <div class="nav-container">
        <a href="../"
          ><div class="nav-logo"><b>ICOFFCL</b></div></a
        >
        <div class="radio-player">
          <span id="playPauseBtn" onclick="toggleRadio()">
            <i class="fas fa-play"></i>
          </span>
          <div class="live-status" id="liveStatus">
            <div class="dot"></div>
            Radio Broadcast
          </div>
          <div class="live-timer" id="liveTimer">00:00</div>
        </div>
        <div class="dropdown">
          <button class="dropbtn"><i class="fas fa-bars"></i></button>
          <div class="dropdown-content">
            <a href="../"><i class="fas fa-home"></i> Home</a>
            <li>
              <a href="#audio"><i class="fas fa-music"></i> Audio</a>
            </li>
            <li>
              <a href="#video"><i class="fas fa-video"></i> Video</a>
            </li>
            <li>
              <a href="#photo"><i class="fas fa-photo-video"></i> Photos</a>
            </li>
            <li>
              <a href="#story"><i class="fas fa-book"></i> Story</a>
            </li>
            <li>
              <a href="#services"><i class="fas fa-cogs"></i> Services</a>
            </li>
          </div>
        </div>
      </div>
    </nav>

    <header>
      <img
        src="https://th.bing.com/th/id/OIP.c0JLxqUl5L8qEQbJm1KexAHaEc?w=1200&h=720&rs=1&pid=ImgDetMain"
        class="cover-photo"
      />
      <div class="profile-section">
        <img
          src="https://assets.audiomack.com/icoffcl/dbd11cf047bc3410d12a84d60fd79a0e7bfb364f866b0534b17175f6de9c9369.jpeg?width=400"
          class="profile-pic"
        />
        <div class="profile-name">Indunil Chathuranga</div>
        <div class="social-links">
          <a href="https://www.youtube.com/@icoffcl" target="_blank"
            ><i class="fab fa-youtube"></i
          ></a>
          <a href="https://www.facebook.com/icoffcl" target="_blank"
            ><i class="fab fa-facebook"></i
          ></a>
          <a href="https://www.tiktok.com/@icoffcl" target="_blank"
            ><i class="fab fa-tiktok"></i
          ></a>
          <a href="https://audiomack.com/icoffcl" target="_blank"
            ><i class="fas fa-music"></i></a
          ><a href="https://www.twitch.tv/icoffcl" target="_blank"
            ><i class="fab fa-twitch"></i
          ></a>
        </div>
      </div>
      <div class="discription">
        <p>
          <strong>Indunil Chathuranga</strong> is a talented and versatile Sri
          Lankan artist. Beyond his artistic pursuits, he is the founder of
          <strong>ICOFFCL</strong>, a forward-thinking creative agency that
          specializes in broadcasting and multi-functional services.
        </p>
        <br />
        <p>
          ICOFFCL is committed to delivering innovative solutions to the media
          industry, adapting to the ever-evolving demands of the digital age.
          The agency offers a diverse range of services, including audio and
          video content creation, photography, editing, logo design, and
          typesetting, providing high-quality media solutions tailored to
          today’s needs.
        </p>

        <div class="contact-info" style="margin-top: 20px">
          <p><strong>Contact for Business Inquiries:</strong></p>
          <p>
            <a
              href="https://wa.me/94741688487"
              target="_blank"
              rel="noopener noreferrer"
            >
              <i class="fab fa-whatsapp"></i> +94 741 688 487 </a
            ><br />
            <a href="mailto:indunilchathurangaofficial@gmail.com">
              <i class="fas fa-envelope"></i>
              indunilchathurangaofficial@gmail.com
            </a>
          </p>
        </div>
      </div>
    </header>

    <main>
      <div class="main-content">
        <!-- Post 1 -->
        <a href="../avihinsaka-premaya">
          <div class="card">
            <img
              src="https://assets.audiomack.com/icoffcl/888602aa27fdc4fdbea033e322bf75ecde263a9e1ea44c9cf99c93cdc796a9cc.jpeg?width=600"
            />
            <div class="card-content">
              <div class="card-title">Avihinsaka Premaya</div>
              <div class="card-text">
                <i class="fas fa-user"></i> Indunil Chathuranga<br />
                <i class="fas fa-calendar-alt"></i> 2025.05.12 | 04:00 PM
              </div>
            </div>
          </div>
        </a>
      </div>
    </main>

    <footer>
      © <span id="currentYear"></span> Indunil Chathuranga. All rights reserved.
    </footer>

    <script src="../script.js"></script>

    <script>
      // Dropdown menu toggle
      document.querySelector(".dropbtn").addEventListener("click", function () {
        const dropdownContent = document.querySelector(".dropdown-content");
        dropdownContent.style.display =
          dropdownContent.style.display === "block" ? "none" : "block";
      });

      // Close dropdown if clicked outside
      window.addEventListener("click", function (e) {
        if (!e.target.closest(".dropdown")) {
          document.querySelector(".dropdown-content").style.display = "none";
        }
      });

      const { pathname, search, hash } = window.location;
      if (pathname.endsWith("/") && pathname !== "/") {
        const newPath = pathname.slice(0, -1);
        const newUrl = newPath + search + hash;
        history.replaceState(null, "", newUrl);
      }

      // Function to remove file extension from the URL
      function removeFileExtension() {
        // Get the current URL
        let currentUrl = window.location.href;

        // Regular expression to remove common file extensions (.html, .css, .js, .php, .png, .jpg, .jpeg, .gif, .mp3, .mp4, .svg, etc.)
        let newUrl = currentUrl.replace(
          /\.(html|css|js|php|png|jpg|jpeg|gif|mp3|mp4|svg|txt|json|xml)$/i,
          ""
        );

        // If the URL has been changed, update the browser's address bar
        if (currentUrl !== newUrl) {
          window.history.replaceState(null, null, newUrl);
        }
      }

      // Call the function to remove the file extension
      removeFileExtension();

      // Offline HTML (for offline mode)
      const offlineHTML = `
  <style>
    * {
      user-select: none !important;
      -webkit-user-drag: none !important;
      pointer-events: none !important;
    }
    html, body {
      margin: 0;
      background: #000;
      color: red;
      font-family: sans-serif;
      overflow: hidden;
      height: 100vh;
    }
    .offline-box {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      flex-direction: column;
      pointer-events: auto;
    }
    .offline-box h1 {
      font-size: 60px;
      margin-bottom: 10px;
      animation: pulse 1.5s infinite;
    }
    .offline-box p {
      font-size: 18px;
      color: #eee;
    }
    @keyframes pulse {
      0% { text-shadow: 0 0 10px red; }
      50% { text-shadow: 0 0 30px red; }
      100% { text-shadow: 0 0 10px red; }
    }
  </style>
  <div class="offline-box">
    <h1>OFFLINE</h1>
    <p>No internet connection. Please reconnect.</p>
  </div>
`;

      // Online HTML (shown briefly before reload)
      const onlineHTML = `
  <style>
    html, body {
      margin: 0;
      background: #001100;
      color: #00ff00;
      font-family: sans-serif;
      overflow: hidden;
      height: 100vh;
    }
    .online-box {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      flex-direction: column;
    }
    .online-box h1 {
      font-size: 60px;
      margin-bottom: 10px;
    }
    .online-box p {
      font-size: 18px;
      color: #aaffaa;
    }
  </style>
  <div class="online-box">
    <h1>ONLINE</h1>
    <p>Connection restored. Reloading...</p>
  </div>
`;

      // Clear all browser data and display offline screen
      function goOffline() {
        try {
          localStorage.clear();
          sessionStorage.clear();
          if (indexedDB?.databases) {
            indexedDB.databases().then((dbs) => {
              for (const db of dbs) indexedDB.deleteDatabase(db.name);
            });
          }
          if ("caches" in window) {
            caches.keys().then((keys) => keys.forEach((k) => caches.delete(k)));
          }
          if ("serviceWorker" in navigator) {
            navigator.serviceWorker.getRegistrations().then((regs) => {
              regs.forEach((r) => r.unregister());
            });
          }
        } catch (e) {
          console.error("Error clearing data:", e);
        }

        document.documentElement.innerHTML = `<head></head><body>${offlineHTML}</body>`;

        // Disable refresh and interaction
        window.addEventListener("keydown", (e) => {
          if (
            ((e.ctrlKey || e.metaKey) && (e.key === "r" || e.key === "R")) ||
            e.key === "F5"
          )
            e.preventDefault();
        });
        window.addEventListener("contextmenu", (e) => e.preventDefault());
        window.addEventListener("dragstart", (e) => e.preventDefault());
      }

      // Show online message and reload after delay
      function goOnline() {
        document.documentElement.innerHTML = `<head></head><body>${onlineHTML}</body>`;
        setTimeout(() => {
          location.reload(true); // Hard refresh
        }, 2000);
      }

      // Event listeners
      window.addEventListener("offline", goOffline);
      window.addEventListener("online", goOnline);

      // Trigger immediately on load if offline
      if (!navigator.onLine) {
        goOffline();
      }
    </script>

    <script>
      const audioStream = new Audio("https://stream.zeno.fm/eownpnzhffvtv");
      const playPauseBtn = document.getElementById("playPauseBtn");
      const liveTimer = document.getElementById("liveTimer");
      const liveStatus = document.getElementById("liveStatus");
      const liveDot = liveStatus.querySelector(".dot");
      const radioPlayer = document.getElementById("radioPlayer");

      let isPlaying = false;
      let seconds = 0;
      let interval = null;

      function updateTimer() {
        seconds++;
        const mins = String(Math.floor(seconds / 60)).padStart(2, "0");
        const secs = String(seconds % 60).padStart(2, "0");
        liveTimer.textContent = `${mins}:${secs}`;
      }

      function toggleRadio() {
        if (isPlaying) {
          audioStream.pause();
          clearInterval(interval);
          seconds = 0;
          liveTimer.textContent = "00:00";
          playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
          liveStatus.innerHTML =
            '<div class="dot" style="display: none;"></div>Radio Broadcast';
          isPlaying = false;
        } else {
          liveStatus.innerHTML =
            '<div class="dot" style="display: none;"></div>Buffering...';
          audioStream.load();
          audioStream.play().catch(() => {
            // If play fails, assume offline
            radioPlayer.style.display = "none";
            setTimeout(() => location.reload(), 3000); // Try reconnecting
          });
        }
      }

      audioStream.addEventListener("canplay", () => {
        // Stream is ready, auto-show player
        radioPlayer.style.display = "block";
        audioStream.play();
      });

      audioStream.addEventListener("playing", () => {
        // Stream started playing
        if (!isPlaying) {
          interval = setInterval(updateTimer, 1000);
          isPlaying = true;
        }
        liveStatus.innerHTML =
          '<div class="dot" style="display:inline-block;"></div>Live Radio Broadcast';
        playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
        radioPlayer.style.display = "block";
      });

      audioStream.addEventListener("waiting", () => {
        // Buffering
        liveStatus.innerHTML =
          '<div class="dot" style="display:none;"></div>Buffering...';
        clearInterval(interval);
      });

      audioStream.addEventListener("pause", () => {
        clearInterval(interval);
        liveStatus.innerHTML =
          '<div class="dot" style="display:none;"></div>Radio Broadcast';
        isPlaying = false;
      });

      audioStream.addEventListener("error", () => {
        // Stream offline
        radioPlayer.style.display = "none";
        setTimeout(() => location.reload(), 5000); // Retry after 5s
      });

      // Auto check if stream comes back online every 10 seconds
      setInterval(() => {
        fetch("https://stream.zeno.fm/eownpnzhffvtv")
          .then((res) => {
            if (res.ok && radioPlayer.style.display === "none") {
              location.reload(); // Stream is back online, reload to restore
            }
          })
          .catch(() => {
            // Still offline, do nothing
          });
      }, 10000);
    </script>
  </body>
</html>
